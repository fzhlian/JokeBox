"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.NativeCommandBuilder=void 0;const fs_1=__importDefault(require("fs")),file_util_js_1=require("../utils/file-util.js"),base_command_builder_js_1=require("./base-command-builder.js"),hvigor_1=require("@ohos/hvigor"),common_const_js_1=require("../const/common-const.js"),ohos_logger_1=require("../utils/log/ohos-logger"),build_mode_const_1=require("../const/build-mode-const");class NativeCommandBuilder extends base_command_builder_js_1.BaseCommandBuilder{constructor(t){super([]),this.log=ohos_logger_1.OhosLogger.getLogger(NativeCommandBuilder.name),this.commandList.push(t)}addCmakeList(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push(`-H${t}`),this}addTempFilePath(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push(`-B${t}`),this}addOhosArch(t){return this.commandList.push(`-DOHOS_ARCH=${t}`),this}addOutputDir(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push(`-DCMAKE_LIBRARY_OUTPUT_DIRECTORY=${t}`),this}addCMakeFindPath(t){return file_util_js_1.FileUtil.checkPathLength(t),fs_1.default.existsSync(t)&&this.commandList.push(`-DCMAKE_FIND_ROOT_PATH=${t}`),this}addPackageFindScript(t){return file_util_js_1.FileUtil.checkPathLength(t),fs_1.default.existsSync(t)&&this.commandList.push(`-DPACKAGE_FIND_FILE=${t}`),this}addBuildType(t){return this.commandList.push(`-DCMAKE_BUILD_TYPE=${this.getConfigCMakeBuildType(t)}`),this}getConfigCMakeBuildType(t){if(t===build_mode_const_1.BuildMode.DEBUG)return common_const_js_1.CMakeBuildType.Debug;const e=hvigor_1.hvigorCore.getParameter().getPropertyInternal(common_const_js_1.HvigorConfigConst.OHOS_DEFAULTS_RELEASE_CMAKEBUILDTYPE),i=Object.values(common_const_js_1.CMakeBuildType);return e&&!i.includes(e)&&this.log.warn("The configured cmake build type for 'Release' in hvigor-config is invalid. The configuration item must be one of 'Release', 'Debug', or 'RelWithDebInfo'. Please check it."),e&&i.includes(e)?e:common_const_js_1.CMakeBuildType.Release}addNativeSdk(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push(`-DOHOS_SDK_NATIVE=${t}`),this}addHMosNativeSdk(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push(`-DHMOS_SDK_NATIVE=${t}`),this}addSystemName(t){return this.commandList.push(`-DCMAKE_SYSTEM_NAME=${t}`),this}addOhosArchAbi(t){return this.commandList.push(`-DCMAKE_OHOS_ARCH_ABI=${t}`),this}exportCompileCommands(t){return this.commandList.push(`-DCMAKE_EXPORT_COMPILE_COMMANDS=${t}`),this}addToolChain(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push(`-DCMAKE_TOOLCHAIN_FILE=${t}`),this}addGenerator(t){return this.commandList.push(`-G${t}`),this}addMakeProgramPath(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push(`-DCMAKE_MAKE_PROGRAM=${t}`),this}addCFlags(t){return this.commandList.push(`-DCMAKE_C_FLAGS=${t}`),this}addCxxFlags(t){return this.commandList.push(`-DCMAKE_CXX_FLAGS=${t}`),this}addOhosCoverage(t){return this.commandList.push(`-DOHOS_TEST_COVERAGE=${t}`),this}changeToDir(t){return file_util_js_1.FileUtil.checkPathLength(t),this.commandList.push("-C"),this.commandList.push(t),this}muteUnusedCliWarn(){return this.commandList.push("--no-warn-unused-cli"),this}}exports.NativeCommandBuilder=NativeCommandBuilder;