"use strict";var __decorate=this&&this.__decorate||function(e,t,o,r){var s,i=arguments.length,n=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,r);else for(var _=e.length-1;_>=0;_--)(s=e[_])&&(n=(i<3?s(n):i>3?s(t,o,n):s(t,o))||n);return i>3&&n&&Object.defineProperty(t,o,n),n},__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateModuleInfo=exports.MODULE_INFO_CODE=void 0;const path_1=__importDefault(require("path")),hvigor_1=require("@ohos/hvigor"),fs_extra_1=__importDefault(require("fs-extra")),inject_util_js_1=require("../../utils/inject-util.js"),task_names_js_1=require("../common/task-names.js"),ohos_hap_task_js_1=require("../task/ohos-hap-task.js"),ohos_uitransform_optimization_js_1=require("./ohos-uitransform-optimization.js");exports.MODULE_INFO_CODE="\n//@ts-noCheck\nexport const __MODULE_NAME__: string = __getCurrentModuleName__()\nexport const __BUNDLE_NAME__: string = __getCurrentBundleName__()\n";class CreateModuleInfo extends ohos_hap_task_js_1.OhosHapTask{constructor(e){super(e,task_names_js_1.TaskNames.CommonTask.CREATE_MODULE_INFO),this.outputFile=this.pathInfo.getGenerateModuleInfoPath()}beforeTask(){fs_extra_1.default.existsSync(this.outputFile)&&fs_extra_1.default.removeSync(this.outputFile)}get ohosUiTransformOptimization(){return(0,ohos_uitransform_optimization_js_1.getOhosUiTransformOptimization)(this.targetService)}get integratedHspUseGetCurrentBundleName(){return inject_util_js_1.InjectUtil.isIntegratedHspUseGetCurrentBundleName()&&this.targetService.isIntegratedHsp()}taskShouldDo(){return(0,ohos_uitransform_optimization_js_1.getOhosUiTransformOptimization)(this.targetService)||this.integratedHspUseGetCurrentBundleName}async doTaskAction(){fs_extra_1.default.ensureDirSync(path_1.default.dirname(this.outputFile)),fs_extra_1.default.writeFileSync(this.outputFile,exports.MODULE_INFO_CODE,{encoding:"utf-8"})}initTaskDepends(){}}__decorate([(0,hvigor_1.OutputFile)({isDirectory:!1})],CreateModuleInfo.prototype,"outputFile",void 0),__decorate([(0,hvigor_1.Input)()],CreateModuleInfo.prototype,"ohosUiTransformOptimization",null),__decorate([(0,hvigor_1.Input)()],CreateModuleInfo.prototype,"integratedHspUseGetCurrentBundleName",null),exports.CreateModuleInfo=CreateModuleInfo;