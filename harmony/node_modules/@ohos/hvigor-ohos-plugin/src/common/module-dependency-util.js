"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.moduleDependencyUtil=void 0;const module_type_enum_js_1=require("../enum/module-type-enum.js"),dependency_interface_js_1=require("../project/dependency/core/dependency-interface.js"),dependency_manager_js_1=require("../project/dependency/dependency-manager.js");class ModuleDependencyUtil{constructor(){this.pureHar=new Set}getPureHar(e,n,d,t){return 0===this.pureHar.size&&this.init(e,n,d,t),this.pureHar}init(e,n,d,t){if(n.getModuleType()!==module_type_enum_js_1.ModuleType.Entry)return;e.getDirectDependencies().filter(e=>e.isLocal()&&e.getDependencyType()===dependency_interface_js_1.DependencyType.DEPENDENCY_TYPE_HAR).forEach(e=>{this.collectPureHar(d,e,t)})}collectPureHar(e,n,d){var t,r,c;const o=e.getModuleModelByName(null!==(c=null===(r=null===(t=n.getModuleJsonObj())||void 0===t?void 0:t.module)||void 0===r?void 0:r.name)&&void 0!==c?c:n.getPackageName());if(o){const n=new dependency_manager_js_1.DependencyManager(d,o,e).collectAllDependencies().npmDependencies,t=n.some(e=>e.isLocal()&&e.getDependencyType()===dependency_interface_js_1.DependencyType.DEPENDENCY_TYPE_HSP);t||(this.pureHar.add(o.getName()),n.forEach(e=>{var n,d,t;this.pureHar.add(e.isLocal()&&null!==(t=null===(d=null===(n=e.getModuleJsonObj())||void 0===n?void 0:n.module)||void 0===d?void 0:d.name)&&void 0!==t?t:e.getPackageName())}))}}}exports.moduleDependencyUtil=new ModuleDependencyUtil;