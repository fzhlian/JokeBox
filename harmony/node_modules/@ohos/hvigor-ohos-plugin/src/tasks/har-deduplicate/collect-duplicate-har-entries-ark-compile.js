"use strict";var __decorate=this&&this.__decorate||function(e,t,r,i){var a,o=arguments.length,p=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)p=Reflect.decorate(e,t,r,i);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(p=(o<3?a(p):o>3?a(t,r,p):a(t,r))||p);return o>3&&p&&Object.defineProperty(t,r,p),p};Object.defineProperty(exports,"__esModule",{value:!0}),exports.CollectDuplicateHarEntriesArkCompile=void 0;const hvigor_1=require("@ohos/hvigor"),collect_duplicate_har_dependencies_js_1=require("../../har-dedepulicate/collect_duplicate_har_dependencies.js"),ark_compile_js_1=require("../ark-compile.js");class CollectDuplicateHarEntriesArkCompile extends ark_compile_js_1.ArkCompile{constructor(e,t,r){super(e,t,r),this.hspNeedDeduplicateHarInfoMap=(0,collect_duplicate_har_dependencies_js_1.getHspNeedDeduplicateHarInfoMap)(this.moduleName)}async initDefaultArkCompileConfig(){const e=await super.initDefaultArkCompileConfig();return e.isHarDeduplicateArkCompile=!0,this.hspNeedDeduplicateHarInfoMap&&Object.keys(this.hspNeedDeduplicateHarInfoMap).length>0&&(e.hspDeduplicateHarInfo=this.hspNeedDeduplicateHarInfoMap),e}taskShouldDo(){return this.targetService.shouldDoDeduplicateTask()&&void 0!==this.hspNeedDeduplicateHarInfoMap&&Object.keys(this.hspNeedDeduplicateHarInfoMap).length>0}declareOutputFiles(){const e=new hvigor_1.FileSet;if(this.hspNeedDeduplicateHarInfoMap){let t=!1,r=!1;for(const e of Object.values(this.hspNeedDeduplicateHarInfoMap))if(e.isByteCodeHarDependency?t=!0:e.isHarDependency&&(r=!0),t&&r)break;t&&e.addEntry(this.pathInfo.getByteCodeHarDuplicateFilesInfoPath()),r&&e.addEntry(this.pathInfo.getSourceHarDuplicateFilesInfoPath())}return e}}__decorate([(0,hvigor_1.Input)()],CollectDuplicateHarEntriesArkCompile.prototype,"hspNeedDeduplicateHarInfoMap",void 0),exports.CollectDuplicateHarEntriesArkCompile=CollectDuplicateHarEntriesArkCompile;