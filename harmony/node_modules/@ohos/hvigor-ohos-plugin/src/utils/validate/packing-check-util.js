"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.PackingCheckUtil=void 0;const glob_1=require("glob"),path_1=__importDefault(require("path")),fs_extra_1=__importDefault(require("fs-extra")),file_util_js_1=require("../file-util.js");class PackingCheckUtil{static getResourcePaths(e){var t;const r=e.getTargetData().getPathInfo().getModulePath(),s=null===(t=e.getTargetData().getTargetOpt().resource)||void 0===t?void 0:t.directories;return(null==s?void 0:s.length)?s.map(e=>file_util_js_1.FileUtil.convertToAbsolutePath(e,r)):[e.getTargetData().getModuleSourceSetModel().getTargetResPath()]}static collectSourceCodeFiles(e,t){const r=[".c",".h",".cpp",".cs",".java",".rs",".py",".go",".ets",".js",".ts"];if(!fs_extra_1.default.existsSync(e))return[];return glob_1.glob.sync("**/*",{cwd:e,absolute:!1,dot:!0}).filter(null!=t?t:e=>r.some(t=>e.endsWith(t)))}static recoverOriginalPath(e,t){return e.filter(e=>fs_extra_1.default.existsSync(path_1.default.resolve(t,e))).map(e=>path_1.default.resolve(t,e))}static recoverPackagedFiles(e,t){if(!fs_extra_1.default.existsSync(t))return[];let r;return this.resourceFilesCache.has(t)?r=this.resourceFilesCache.get(t):(r=new Set(glob_1.glob.sync("**/*",{cwd:t,absolute:!1,dot:!0})),this.resourceFilesCache.set(t,r)),e.filter(e=>r.has(e))}static clearResourceFilesCache(){this.resourceFilesCache.clear()}}exports.PackingCheckUtil=PackingCheckUtil,PackingCheckUtil.resourceFilesCache=new Map;