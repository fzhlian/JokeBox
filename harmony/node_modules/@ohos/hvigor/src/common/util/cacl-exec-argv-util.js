"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.calcChildExecArgv=void 0;const process_1=__importDefault(require("process")),hvigor_log_js_1=require("../../base/log/hvigor-log.js"),hvigor_config_reader_js_1=require("../../base/util/hvigor-config-reader.js"),const_js_1=require("../const/const.js"),logger=hvigor_log_js_1.HvigorLogger.getLogger(hvigor_config_reader_js_1.HvigorConfigReader.name);function calcChildExecArgv(e=!1){var r,o;const s=[...process_1.default.execArgv],i=`--max-old-space-size=${hvigor_config_reader_js_1.HvigorConfigReader.getMaxOldSpaceSize(e)}`,_=s.findIndex(e=>e.startsWith("--max-old-space-size="));-1!==_&&s[_]?s[_]=i:s.push(i);const c=`--max-semi-space-size=${hvigor_config_reader_js_1.HvigorConfigReader.getMaxSemiSpaceSize(e)}`,a=s.findIndex(e=>e.startsWith("--max-semi-space-size="));-1!==a&&s[a]?s[a]=c:s.push(c);const g=null===(o=null===(r=hvigor_config_reader_js_1.HvigorConfigReader.getHvigorConfig())||void 0===r?void 0:r.nodeOptions)||void 0===o?void 0:o.exposeGC,t=s.indexOf("--expose-gc");!1===g||-1!==t&&s[t]?!1!==g||-1===t&&!s[t]||s.splice(t,1):s.push("--expose-gc");const n=hvigor_config_reader_js_1.HvigorConfigReader.getStacktrace(e);return s.some(e=>e===const_js_1.ENABLE_SOURCE_MAPS)?!n&&logger.warn(`"${const_js_1.ENABLE_SOURCE_MAPS}" is enabled but has no effect because "stacktrace" is disabled. Please enable "stacktrace" first.`):n&&s.push(const_js_1.ENABLE_SOURCE_MAPS),s}exports.calcChildExecArgv=calcChildExecArgv;